<div class="container">
  <h1>Añadir interesado</h1>
  <form [formGroup]="formulario" (ngSubmit)="guardarPropietario()">

    <mat-form-field class="custom-input ">
      <mat-label>Tipo de Documento</mat-label>
      <mat-select formControlName="tipoDocumento">
        @for (tipoDoc of array_CR_DocumentoTipo; track tipoDoc) {
          <mat-option [value]="tipoDoc">{{tipoDoc}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Documento Identidad</mat-label>
      <input matInput formControlName="documentoIdentidad">
      @if (formulario.get('documentoIdentidad')?.invalid) {
        <mat-error>
          Documento de Identidad es obligatorio.
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Tipo de Persona</mat-label>
      <mat-select formControlName="tipo">
        @for (tipo of array_CR_InteresadoTipo; track tipo) {
          <mat-option [value]="tipo">{{tipo}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Primer Nombre</mat-label>
      <input matInput formControlName="primerNombre">
      @if(formulario.get('primerNombre')?.invalid){
        <mat-error>
          Primer Nombre es obligatorio.
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="custom-input">
      <mat-label>Segundo Nombre</mat-label>
      <input matInput formControlName="segundoNombre">
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Primer Apellido</mat-label>
      <input matInput formControlName="primerApellido">
      @if(formulario.get('primerApellido')?.invalid){
        <mat-error>
          Primer Apellido es obligatorio.
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="custom-input">
      <mat-label>Segundo Apellido</mat-label>
      <input matInput formControlName="segundoApellido">
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Sexo</mat-label>
      <mat-select formControlName="sexo">
        @for (sexo of array_CR_SexoTipo; track sexo) {
          <mat-option [value]="sexo">{{sexo}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input">
      <mat-label>Grupo Étnico</mat-label>
      <mat-select formControlName="grupoEtnico">
        @for (grupo of array_Grupo_Etnico; track grupo) {
          <mat-option [value]="grupo">{{grupo}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input">
      <mat-label>Teléfono 1</mat-label>
      <input matInput type="tel" formControlName="telefono1">
    </mat-form-field>

    <mat-form-field class="custom-input">
      <mat-label>Teléfono 2</mat-label>
      <input matInput type="tel" formControlName="telefono2">
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Correo Electrónico</mat-label>
      <input matInput type="email" formControlName="correoElectronico">
      @if(formulario.get('correoElectronico')?.invalid) {
        <mat-error>
          Correo Electrónico no es válido.
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Departamento</mat-label>
      <mat-select formControlName="departamentoSeleccionado" (selectionChange)="onDepartamentoChange()">
        @for (depto of departamentos | alphabeticalOrder:'departamento'; track depto) {
          <mat-option [value]="depto.departamento">{{depto.departamento}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>Municipio</mat-label>
      <mat-select formControlName="municipioSeleccionado">
        @for (mun of municipiosFiltrados | alphabeticalOrder:'nombre_municipio'; track mun) {
          <mat-option [value]="mun.codigo_municipio">{{mun.nombre_municipio}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="custom-input ">
      <mat-label>% Propiedad</mat-label>
      <input matInput type="number" formControlName="porcentajePropiedad" min="1" max="100">
      @if (formulario.get('porcentajePropiedad')?.invalid) {
        <mat-error>
          % Propiedad debe ser un número entre 1 y 100.
        </mat-error>
      }
    </mat-form-field>

    <mat-radio-group formControlName="estado">
      <mat-radio-button value="Casado">Casado</mat-radio-button>
      <mat-radio-button value="Soltero">Soltero</mat-radio-button>
    </mat-radio-group>

    <mat-form-field class="custom-input">
      <mat-label>Notas</mat-label>
      <textarea matInput formControlName="notas"></textarea>
    </mat-form-field>

    <mat-checkbox formControlName="autorizaProcesamientoDatosPersonales" >
      Autoriza procesamiento de datos personales
    </mat-checkbox>

    <mat-checkbox formControlName="autorizaNotificacionCorreo" >
      Autoriza notificación por correo
    </mat-checkbox>

    <button mat-raised-button class="custom-button" type="submit" [disabled]="!formulario.valid">Guardar</button>
    <button mat-raised-button class="custom-button" routerLink="../">Atrás</button>
  </form>
</div>
